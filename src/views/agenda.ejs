<!DOCTYPE html>
<html lang="fr">

<head>
    <meta charset="UTF-8">
    <title>Agenda</title>
    <link rel="stylesheet"
          href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200" />
    <link rel="stylesheet" href="/css/agenda.css">
    <link rel="stylesheet" href="/css/newEvent.css">
</head>
<body>
<% /* global locals,agenda,agendas */ %>
<%- include('partials/header') %>

<div class="header-middle">
    <span class="header-title"><%= agenda.name %></span>
    <span class="material-symbols-outlined edit-icon" id="editAgenda" title="Modifier l'agenda">edit</span>
</div>

<div id="menuAgendas" class="buttons-nav">
    <button class="icon-button" id="menu-button" onclick="toggleMenu()">
        <span class="material-symbols-outlined">menu</span>
    </button>
    <!-- Menu déroulant - liste de tous les agendas de l'utilisateur -->
    <div id="dropdown-menu" class="dropdown-menu" style="display: none;">
        <h3 class="agenda-title">Agendas</h3>
        <ul class="agenda-list">
            <% agendas.filter(agenda => agenda.ownerId === locals.user.id && agenda.agendaId !== locals.agenda.agendaId).
            forEach(agenda => { %>
                <li class="agenda-item">
                    <a href="/agenda/<%= agenda.agendaId %>">
                        <span class="material-symbols-outlined" style="margin-right: 10px; font-size: 20px; color:<%= agenda.color %>">event_note</span>
                        <%= agenda.name %>
                    </a>
                </li>
            <% }) %>
        </ul>
    </div>
</div>

<!-- Pop Up - Création de l'agenda -->
<div id="newAgenda" class="modal">
    <div class="modal-content">
        <span class="close-btn" id="closeViewAgendaCreation">&times;</span>
        <h2>Créer un Agenda</h2>
        <form>
            <label for="agenda-name">Nom:</label>
            <input type="text" id="agenda-name" name="agenda-name" required>

            <label for="agenda-description">Description:</label>
            <textarea  id="agenda-description" name="agenda-description" rows="3"></textarea>

            <label for="agenda-color">Couleur:</label>
            <input type="color" id="agenda-color" value="#2196f3"/>

            <p id="agenda-creation-error" style="color: red; display: none;">Le nom est requis.</p>

            <button id="saveAgenda" class="submit-btn">Créer l'agenda</button>
        </form>
    </div>
</div>

<!-- Pop Up - Modification de l'agenda -->
<div id="editAgendaModal" class="modal">
    <div class="modal-content">
        <span class="close-btn" id="closeEditAgenda">&times;</span>
        <h2>Modifier le nom de l'agenda:</h2>
        <form id="editAgendaForm">
            <label for="new-agenda-name">Nom de l'agenda:</label>
            <input type="text" id="new-agenda-name" name="new-agenda-name" required>
            <button type="submit" class="submit-btn">Mettre à jour</button>
        </form>
    </div>
</div>


<script src="/js/agenda/agendaCreation.js"></script>
<script src="/js/agenda/agendaMenu.js"></script>
<script>
  const agenda = {
    agendaId: "<%= agenda.agendaId %>",
    color: "<%= agenda.color %>",
    name: "<%= agenda.name %>"
  };
</script>
<script src="/js/agenda/agendaEdition.js"></script>
<link rel="stylesheet" href="css/agenda.css">

<%- include('calendar') %>
<%- include('partials/footer') %>
</body>
</html>
